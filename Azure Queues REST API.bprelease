<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>Azure Queues REST API - 20200420</bpr:name>
    <bpr:release-notes />
    <bpr:created>2020-04-20 17:21:39Z</bpr:created>
    <bpr:package-id>23</bpr:package-id>
    <bpr:package-name>Azure Queues REST API</bpr:package-name>
    <bpr:user-created-by>admin</bpr:user-created-by>
    <bpr:contents count="5">
        <process id="5bc440a8-5066-4269-8ab7-065823ad2a4d" name="Blueprism - Azure Queues REST API Sample" xmlns="http://www.blueprism.co.uk/product/process"><process name="Blueprism - Azure Queues REST API Sample" version="1.0" bpversion="6.7.0.20116" narrative="" byrefcollection="true"><view><camerax>0</camerax><cameray>113</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="b0563ffb-359f-4be1-abc9-90981d07a3ec" type="Normal" published="False"><name>Get Messages And Log Each</name><view><camerax>0</camerax><cameray>20</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="8740a40d-c8fc-4da1-a891-32f24f4ec496" type="Normal" published="False"><name>Get Single Message And Log</name><view><camerax>0</camerax><cameray>45</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee" type="Normal" published="False"><name>Add New Message</name><view><camerax>0</camerax><cameray>124</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="c7780dfd-0979-4aeb-b3cb-7479a2b37c63" type="Normal" published="False"><name>Add New Message and Delete It</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="7fa1760a-b8ee-4925-868a-094e79988a7c" name="Start" type="Start"><display x="0" y="-165" /><onsuccess>1ee2abf6-7591-40fd-9352-f77eb7a6cace</onsuccess></stage><stage stageid="d51d2c7f-833c-4b32-85b1-d76db9fdbe63" name="End" type="End"><display x="0" y="270" /></stage><stage stageid="ff81b943-9e5b-410c-a88b-0d715a039c98" name="Stage1" type="ProcessInfo"><display x="-195" y="-135" w="150" h="90" /></stage><stage stageid="1c7a90fb-cd2f-4f57-b32d-35d8be351967" name="Success" type="Data"><display x="-195" y="-15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0b2b48ff-e645-4534-ac47-110a4ac94ce0" name="Result" type="Data"><display x="-195" y="-45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ce4399c0-12a5-46dc-8e7a-d7292fd42a29" name="Local Data Items" type="Block"><display x="-270" y="-75" w="150" h="240" /><font family="Segoe UI" size="10" style="Regular" color="339966" /></stage><stage stageid="85f0654f-59c4-4968-861a-30a86d00c188" name="Get Messages And Log Each" type="SubSheetInfo"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-255" y="-105" w="270" h="90" /></stage><stage stageid="539fb347-c24d-42a4-9094-c95d913bb1b4" name="Start" type="Start"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="0" y="-135" /><onsuccess>a31c800a-7076-4be7-8635-b18d4581bbde</onsuccess></stage><stage stageid="e8259b71-f627-4d48-81a9-1011705e231c" name="End" type="End"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="0" y="195" /></stage><stage stageid="3c1f71ca-905c-4fff-b5a5-35a2a41487f6" name="Get Messages And Log Each" type="SubSheet"><display x="0" y="-30" w="90" h="60" /><onsuccess>6fc3de76-eac3-450c-be73-5cfaf6803628</onsuccess><processid>b0563ffb-359f-4be1-abc9-90981d07a3ec</processid></stage><stage stageid="eaf1c648-6624-4cc3-8443-7d808e920d7a" name="Number of Seconds to Hold Messages" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-315" y="-15" w="120" h="30" /><datatype>number</datatype><initialvalue>1</initialvalue><private /><alwaysinit /></stage><stage stageid="c4bb7350-4587-4837-9740-831a609e1138" name="Number of Records to Retrieve" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-315" y="15" w="120" h="30" /><datatype>number</datatype><initialvalue>32</initialvalue><private /><alwaysinit /></stage><stage stageid="b5a41cac-bd2c-490f-8057-9ae9411d213a" name="Success" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-315" y="45" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5c41a76a-08e0-432e-b2c1-dfbfd4c89263" name="Result" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-315" y="75" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3d43eeab-01a2-423b-81cc-8919af444fdd" name="Messages" type="Collection"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-315" y="105" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="0c652b3a-5c41-4436-8111-54a9770af73b" name="Loop Messages" type="LoopStart"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="0" y="15" w="120" h="30" /><onsuccess>1a3f82d8-66da-4024-9ff8-4d8c2047c577</onsuccess><groupid>663d7241-bb83-40fc-a51c-c01813215d21</groupid><looptype>ForEach</looptype><loopdata>Messages</loopdata></stage><stage stageid="debc1a3e-fc31-4c59-bc49-0fcb9ae2f1cc" name="Loop Messages" type="LoopEnd"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="0" y="135" w="120" h="30" /><onsuccess>e8259b71-f627-4d48-81a9-1011705e231c</onsuccess><groupid>663d7241-bb83-40fc-a51c-c01813215d21</groupid></stage><stage stageid="1a3f82d8-66da-4024-9ff8-4d8c2047c577" name="Assign Message Values for Logging" type="MultipleCalculation"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="0" y="75" w="90" h="60" /><onsuccess>debc1a3e-fc31-4c59-bc49-0fcb9ae2f1cc</onsuccess><steps><calculation expression="&quot;Message Id:  &quot; &amp; [Messages.MessageId]" stage="Message Id" /><calculation expression="&quot;Message Content:  &quot; &amp; [Messages.MessageText]" stage="Message Content" /><calculation expression="&quot;Message Pop Receipt:  &quot; &amp; [Messages.PopReceipt]" stage="Message Pop Receipt" /><calculation expression="&quot;Message Dequeue Count:  &quot; &amp; [Messages.DequeueCount]" stage="Dequeue Count" /><calculation expression="&quot;Message Insertion Time:  &quot; &amp; [Messages.InsertionTime]" stage="Insertion Time" /><calculation expression="&quot;Message Expiration Time:  &quot; &amp; [Messages.ExpirationTime]" stage="Expiration Time" /><calculation expression="&quot;Message Time Next Visible:  &quot; &amp; [Messages.TimeNextVisible]" stage="Time Next Visible" /></steps></stage><stage stageid="9f3c6fba-81d8-4730-bc72-4cada8f62d88" name="Message Id" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bccd3fb2-34c0-46eb-b3b3-0180f251c757" name="Local Data Items" type="Block"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-390" y="-45" w="270" h="270" /><font family="Segoe UI" size="10" style="Regular" color="339966" /></stage><stage stageid="f904d69a-8bed-4204-99c2-41827861c964" name="Get Single Message And Log" type="SubSheetInfo"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-255" y="-105" w="270" h="90" /></stage><stage stageid="c1f2bf73-ea9c-444c-81b8-f31cd4436247" name="Start" type="Start"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="0" y="-135" /><onsuccess>22689860-0198-4955-9181-2118af8b142a</onsuccess></stage><stage stageid="6fc3de76-eac3-450c-be73-5cfaf6803628" name="Get Single Message And Log" type="SubSheet"><display x="0" y="45" w="90" h="60" /><onsuccess>02183644-d9c7-41de-ba67-7d82adaf53d2</onsuccess><processid>8740a40d-c8fc-4da1-a891-32f24f4ec496</processid></stage><stage stageid="1e60cd02-385b-4708-a5f5-7f2c8b0b6a74" name="Add New Message" type="SubSheetInfo"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-255" y="-105" w="270" h="90" /></stage><stage stageid="43f7cb4e-1fb4-4572-b79d-a0585e7ddbc1" name="Start" type="Start"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="0" y="-135" /><onsuccess>82672c6e-6a80-42d8-9086-7fbd549bc2a2</onsuccess></stage><stage stageid="04b312d7-31cc-4531-93eb-91f28db59c8a" name="End" type="End"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="0" y="240" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Result" stage="Result" /><output type="collection" name="Messages" stage="Messages" /></outputs></stage><stage stageid="02183644-d9c7-41de-ba67-7d82adaf53d2" name="Add New Message" type="SubSheet"><display x="0" y="120" w="90" h="60" /><outputs><output type="flag" name="Success" friendlyname="Success" stage="Success" /><output type="text" name="Result" friendlyname="Result" stage="Result" /><output type="collection" name="Messages" friendlyname="Messages" stage="Messages" /></outputs><onsuccess>b6dcc898-594f-4170-bf2d-2e221ee1ad98</onsuccess><processid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</processid></stage><stage stageid="82672c6e-6a80-42d8-9086-7fbd549bc2a2" name="Set Message Content" type="Calculation"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="0" y="-75" w="90" h="30" /><onsuccess>dbea163b-4a21-4d9e-9e94-ae8a20aa33c6</onsuccess><calculation expression="&quot;Sample message added to queue via Blueprism Azure Queues REST API VBO on &quot; &amp; Now() &amp; &quot;. Added by &quot; &amp; GetUserName() &amp; &quot;.&quot;" stage="Message Content" /></stage><stage stageid="539e1f54-4e71-4aac-a326-03b10088de3d" name="Success" type="Data"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-315" y="240" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9034d728-9611-472a-ae80-0d4b0f0f25e6" name="Result" type="Data"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-315" y="270" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a4dd9baa-e8cd-4e66-93cd-3a57a7e028eb" name="Local Data Items" type="Block"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-390" y="-45" w="270" h="240" /><font family="Segoe UI" size="10" style="Regular" color="339966" /></stage><stage stageid="ff0c50a4-07cd-4826-a7a5-d833360f4893" name="Add New Message and Delete It" type="SubSheetInfo"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="f9aee302-9668-4fdd-97d3-4f32f66f2c87" name="Start" type="Start"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="15" y="-135" /><onsuccess>f32a8e72-cc54-4a77-97df-137c4f1f2962</onsuccess></stage><stage stageid="9767e17f-2e56-4647-af2a-23d9c7cbbf13" name="End" type="End"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="15" y="135" /></stage><stage stageid="b6dcc898-594f-4170-bf2d-2e221ee1ad98" name="Add New Message and Delete It" type="SubSheet"><display x="0" y="195" w="90" h="60" /><onsuccess>d51d2c7f-833c-4b32-85b1-d76db9fdbe63</onsuccess><processid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</processid></stage><stage stageid="f32a8e72-cc54-4a77-97df-137c4f1f2962" name="Add New Message" type="SubSheet"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="15" y="-60" w="90" h="60" /><outputs><output type="flag" name="Success" friendlyname="Success" stage="Success" /><output type="text" name="Result" friendlyname="Result" stage="Result" /><output type="collection" name="Messages" friendlyname="Messages" stage="Messages" /></outputs><onsuccess>e26bbf27-2588-4188-b3ad-cbed16c041ec</onsuccess><processid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</processid></stage><stage stageid="131f313b-dea7-47b8-ac65-27452257d580" name="Success" type="Data"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3b79a478-7365-4849-9b69-27f605b2dc2a" name="Result" type="Data"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e26bbf27-2588-4188-b3ad-cbed16c041ec" name="Message Added?" type="Decision"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="15" y="0" w="90" h="30" /><decision expression="[Success]" /><ontrue>050bd352-9434-471c-9730-c975ab1f7170</ontrue><onfalse>72c7cbc3-d88a-47aa-a0e1-fa30eefb54f7</onfalse></stage><stage stageid="72c7cbc3-d88a-47aa-a0e1-fa30eefb54f7" name="Add Message Exception" type="Exception"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="150" y="0" w="90" h="30" /><exception localized="yes" type="System Exception" detail="&quot;The following error was encountered adding a new message to the queue:  &quot; &amp; [Result]" /></stage><stage stageid="bf282b60-7d33-4ea7-b9e4-778bc023bf6a" name="Local Data Items" type="Block"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="-270" y="-45" w="150" h="210" /><font family="Segoe UI" size="10" style="Regular" color="339966" /></stage><stage stageid="da7055ea-0139-44f2-938f-0c61a235390f" name="Do Work" type="Block"><display x="-75" y="-135" w="300" h="375" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="27d3fabd-9ada-4578-a163-533e5aad5406" name="Recover" type="Recover"><display x="120" y="195" /><onsuccess>87133b11-52d3-46a2-95ee-de74ae169932</onsuccess></stage><stage stageid="87133b11-52d3-46a2-95ee-de74ae169932" name="Resume" type="Resume"><display x="120" y="270" /><onsuccess>d51d2c7f-833c-4b32-85b1-d76db9fdbe63</onsuccess></stage><stage stageid="fa860bb0-f812-4d5c-b11f-8d5a3819939d" name="Output Data Items" type="Block"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-390" y="210" w="270" h="120" /><font family="Segoe UI" size="10" style="Regular" color="800000" /></stage><stage stageid="134fb99a-6178-4f02-b014-b57f6eb3edfe" name="Message Content" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d4185d67-53fc-4175-9f90-deaa1c149c86" name="Message Pop Receipt" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-195" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="183c7cf9-1814-4816-81e7-2b3cd16ff85e" name="Number of Seconds to Hold Messages" type="Data"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-315" y="-15" w="120" h="30" /><datatype>number</datatype><initialvalue>1</initialvalue><private /><alwaysinit /></stage><stage stageid="1ee2abf6-7591-40fd-9352-f77eb7a6cace" name="Get Queue Storage Account Access Key" type="Action"><narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative><display x="0" y="-90" w="120" h="30" /><inputs><input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="[Credential Name]" /></inputs><outputs><output type="password" name="Password" friendlyname="Password" narrative="The password" stage="Global - Access Key" /><output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="Username" /><output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="Expiry Date" /><output type="text" name="Status" friendlyname="Status" narrative="The status" stage="Status" /></outputs><onsuccess>3c1f71ca-905c-4fff-b5a5-35a2a41487f6</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get" /></stage><stage stageid="7259e958-0206-49cd-b085-9104d008a4eb" name="Global - Access Key" type="Data"><display x="-195" y="210" w="120" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><alwaysinit /></stage><stage stageid="ae924b2c-f866-4db8-ae2e-70817cd79d41" name="Expiry Date" type="Data"><display x="-195" y="135" w="120" h="30" /><datatype>date</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="abf6543d-c6e6-4f41-8b0d-fc9e6ce21410" name="Status" type="Data"><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8255dfda-28b6-422b-b021-ede44f4a9635" name="Credential Name" type="Data"><display x="-195" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">Blueprism - Azure Queues REST API</initialvalue><private /><alwaysinit /></stage><stage stageid="ad6a41c5-5ea9-45c3-beb6-fc9bb2b9f93a" name="Username" type="Data"><display x="-195" y="75" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="784d0d78-71d4-434b-9d2f-fa5d74383ce4" name="Global - Stroage Account Name" type="Data"><loginhibit onsuccess="true" /><display x="-195" y="240" w="120" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">bpde</initialvalue><alwaysinit /></stage><stage stageid="ac659def-1d10-4658-b980-ae3706dc371c" name="Global - Queue Name" type="Data"><loginhibit onsuccess="true" /><display x="-195" y="270" w="120" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">bpde-sample-queue</initialvalue><alwaysinit /></stage><stage stageid="a31c800a-7076-4be7-8635-b18d4581bbde" name="Blueprism - Azure Queues REST API::Retrieve Messages" type="Action"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><loginhibit onsuccess="true" /><display x="0" y="-60" w="120" h="60" /><inputs><input type="number" name="Visibility Timeout Seconds" friendlyname="Visibility Timeout Seconds" narrative="Total number of seconds to keep the queue messages retieved invisible to prevent them being processed by another worker. Default is 30." expr="[Number of Seconds to Hold Messages]" /><input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the Azure Queue" expr="[Global - Queue Name]" /><input type="password" name="Acces Key" friendlyname="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" expr="[Global - Access Key]" /><input type="text" name="Storage Account Name" friendlyname="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" expr="[Global - Stroage Account Name]" /><input type="number" name="Number to Retrieve" friendlyname="Number to Retrieve" narrative="The number of messages to retrieve. Can be a number between 1 and 32. Default is 32." expr="[Number of Records to Retrieve]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" friendlyname="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="collection" name="Messages" friendlyname="Messages" narrative="Messages retrieved from the queue" stage="Messages" /><output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" friendlyname="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" friendlyname="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs><onsuccess>0c652b3a-5c41-4436-8111-54a9770af73b</onsuccess><resource object="Blueprism - Azure Queues REST API" action="Retrieve Messages" /></stage><stage stageid="46018473-fb96-4e50-a4f8-a0edc70f5efc" name="Dequeue Count" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-195" y="75" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ebace662-e323-40d1-aee6-5036ff4bb6d3" name="Insertion Time" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b338170a-5463-467f-9da5-46ebd425831b" name="Expiration Time" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-195" y="135" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="330eb4ae-f944-4960-b2d0-0194bd58f9b7" name="Time Next Visible" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-195" y="165" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="22689860-0198-4955-9181-2118af8b142a" name="Blueprism - Azure Queues REST API::Retrieve Next Message" type="Action"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><loginhibit onsuccess="true" /><display x="0" y="-60" w="120" h="60" /><inputs><input type="number" name="Visibility Timeout Seconds" friendlyname="Visibility Timeout Seconds" narrative="Total number of seconds to keep the queue messages retieved invisible to prevent them being processed by another worker. Default is 30." expr="[Number of Seconds to Hold Messages]" /><input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the Azure Queue" expr="[Global - Queue Name]" /><input type="password" name="Acces Key" friendlyname="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" expr="[Global - Access Key]" /><input type="text" name="Storage Account Name" friendlyname="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" expr="[Global - Stroage Account Name]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" friendlyname="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="collection" name="Messages" friendlyname="Messages" narrative="Messages retrieved from the queue" stage="Messages" /><output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" friendlyname="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" friendlyname="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs><onsuccess>84edaddf-8e7c-4db4-ab42-280a4a3c14be</onsuccess><resource object="Blueprism - Azure Queues REST API" action="Retrieve Next Message" /></stage><stage stageid="a05d797e-55bb-4b17-9204-c94a77c38469" name="Number of Seconds to Hold Messages" type="Data"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-315" y="-15" w="120" h="30" /><datatype>number</datatype><initialvalue>1</initialvalue><private /><alwaysinit /></stage><stage stageid="62fc729a-6f55-4a82-bfb5-55d18ab3cfce" name="Success" type="Data"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-315" y="15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="406a204b-f6fa-4aae-b1f2-d624a225c0fd" name="Result" type="Data"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-315" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5165ab1d-faf2-448c-a78c-a84d1beda9d5" name="Messages" type="Collection"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-315" y="75" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="05071d0f-1c78-464b-850a-27b3866f518b" name="Message Id" type="Data"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b452207e-4fbb-4200-ac48-e78c160c17f2" name="Local Data Items" type="Block"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-390" y="-45" w="270" h="240" /><font family="Segoe UI" size="10" style="Regular" color="339966" /></stage><stage stageid="f90d735e-61ae-474b-9e0b-59334942ecf8" name="Message Content" type="Data"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="177fac69-d376-4b2c-a311-9813d8f42639" name="Message Pop Receipt" type="Data"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-195" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5169e376-af05-49de-9999-53f3f72b4ec3" name="Dequeue Count" type="Data"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-195" y="75" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="506601ae-8442-4a2d-9e3b-c68b625783f3" name="Insertion Time" type="Data"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f1ea57f2-92e4-4b24-8cbe-55fc999eb485" name="Expiration Time" type="Data"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-195" y="135" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="667c88ef-aec0-402b-8c13-6621c82cca42" name="Time Next Visible" type="Data"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-195" y="165" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d8242e6a-b33c-4c86-b167-62dff7d04db3" name="End" type="End"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="0" y="195" /></stage><stage stageid="84edaddf-8e7c-4db4-ab42-280a4a3c14be" name="Loop Messages" type="LoopStart"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="0" y="15" w="120" h="30" /><onsuccess>6f68138f-f480-465f-9c45-3aea8d4c224d</onsuccess><groupid>588250ce-c42a-48fb-aefa-0ee48f92ff01</groupid><looptype>ForEach</looptype><loopdata>Messages</loopdata></stage><stage stageid="9fcc3b3c-2f84-4c65-806e-730a0cecc6d7" name="Loop Messages" type="LoopEnd"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="0" y="135" w="120" h="30" /><onsuccess>d8242e6a-b33c-4c86-b167-62dff7d04db3</onsuccess><groupid>588250ce-c42a-48fb-aefa-0ee48f92ff01</groupid></stage><stage stageid="6f68138f-f480-465f-9c45-3aea8d4c224d" name="Assign Message Values for Logging" type="MultipleCalculation"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="0" y="75" w="90" h="60" /><onsuccess>9fcc3b3c-2f84-4c65-806e-730a0cecc6d7</onsuccess><steps><calculation expression="&quot;Message Id:  &quot; &amp; [Messages.MessageId]" stage="Message Id" /><calculation expression="&quot;Message Content:  &quot; &amp; [Messages.MessageText]" stage="Message Content" /><calculation expression="&quot;Message Pop Receipt:  &quot; &amp; [Messages.PopReceipt]" stage="Message Pop Receipt" /><calculation expression="&quot;Message Dequeue Count:  &quot; &amp; [Messages.DequeueCount]" stage="Dequeue Count" /><calculation expression="&quot;Message Insertion Time:  &quot; &amp; [Messages.InsertionTime]" stage="Insertion Time" /><calculation expression="&quot;Message Expiration Time:  &quot; &amp; [Messages.ExpirationTime]" stage="Expiration Time" /><calculation expression="&quot;Message Time Next Visible:  &quot; &amp; [Messages.TimeNextVisible]" stage="Time Next Visible" /></steps></stage><stage stageid="4d4380bd-6adb-40bb-87d3-f0d86949dfd0" name="HTTP Status Code" type="Data"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-315" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6eadb726-5a2c-45ae-bf61-b4e80375154a" name="Response Headers" type="Collection"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-315" y="135" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="109639df-f9e5-4066-8fb7-57557a7b8c50" name="Response Content" type="Data"><subsheetid>8740a40d-c8fc-4da1-a891-32f24f4ec496</subsheetid><display x="-315" y="165" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="788b653d-909f-4164-b4ed-8de5485a1ee4" name="HTTP Status Code" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-315" y="135" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="002b82ac-98d9-4dce-b97f-84360848ba03" name="Response Headers" type="Collection"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-315" y="165" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="64434de3-2a89-465f-bcbd-e86c343b3460" name="Response Content" type="Data"><subsheetid>b0563ffb-359f-4be1-abc9-90981d07a3ec</subsheetid><display x="-315" y="195" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dbea163b-4a21-4d9e-9e94-ae8a20aa33c6" name="Blueprism - Azure Queues REST API::Add Message" type="Action"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><loginhibit onsuccess="true" /><display x="0" y="0" w="120" h="60" /><inputs><input type="number" name="Visibility Timeout Seconds" friendlyname="Visibility Timeout Seconds" narrative="Total number of seconds to keep the queue messages retieved invisible to prevent them being processed by another worker. Default is 30." expr="[Number of Seconds to Hold Messages]" /><input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the Azure Queue" expr="[Global - Queue Name]" /><input type="password" name="Acces Key" friendlyname="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" expr="[Global - Access Key]" /><input type="text" name="Storage Account Name" friendlyname="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" expr="[Global - Stroage Account Name]" /><input type="text" name="Message Content" friendlyname="Message Content" narrative="The content of the message" expr="[Message Content]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" friendlyname="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="collection" name="Messages" friendlyname="Messages" narrative="Messages retrieved from the queue" stage="Messages" /><output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" friendlyname="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" friendlyname="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs><onsuccess>993c4866-73ed-437d-ad7a-3551a5333461</onsuccess><resource object="Blueprism - Azure Queues REST API" action="Add Message" /></stage><stage stageid="fc31df4c-1e3b-4a03-9230-6ef9d43daf0e" name="Messages" type="Collection"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-315" y="300" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="bcbe2e72-17ec-4494-919d-cb700b4ee665" name="HTTP Status Code" type="Data"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-315" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f186baeb-f187-44b3-ae29-0bc799c95a88" name="Response Headers" type="Collection"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-315" y="45" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="9ed52ee2-3efa-43e9-b4f0-22efcf5686fb" name="Response Content" type="Data"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-315" y="75" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="993c4866-73ed-437d-ad7a-3551a5333461" name="Loop Messages" type="LoopStart"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="0" y="60" w="120" h="30" /><onsuccess>11de8b4e-340f-4c39-afdb-266daf277f50</onsuccess><groupid>c665601b-b0f6-4b92-87f2-52909ea3a2db</groupid><looptype>ForEach</looptype><loopdata>Messages</loopdata></stage><stage stageid="da3dc585-6d4e-4770-ae2b-aceefc1007bf" name="Loop Messages" type="LoopEnd"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="0" y="180" w="120" h="30" /><onsuccess>04b312d7-31cc-4531-93eb-91f28db59c8a</onsuccess><groupid>c665601b-b0f6-4b92-87f2-52909ea3a2db</groupid></stage><stage stageid="11de8b4e-340f-4c39-afdb-266daf277f50" name="Assign Message Values for Logging" type="MultipleCalculation"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="0" y="120" w="90" h="60" /><onsuccess>da3dc585-6d4e-4770-ae2b-aceefc1007bf</onsuccess><steps><calculation expression="&quot;Message Id:  &quot; &amp; [Messages.MessageId]" stage="Message Id" /><calculation expression="&quot;Message Content:  &quot; &amp; [Messages.MessageText]" stage="Message Content" /><calculation expression="&quot;Message Pop Receipt:  &quot; &amp; [Messages.PopReceipt]" stage="Message Pop Receipt" /><calculation expression="&quot;Message Dequeue Count:  &quot; &amp; [Messages.DequeueCount]" stage="Dequeue Count" /><calculation expression="&quot;Message Insertion Time:  &quot; &amp; [Messages.InsertionTime]" stage="Insertion Time" /><calculation expression="&quot;Message Expiration Time:  &quot; &amp; [Messages.ExpirationTime]" stage="Expiration Time" /><calculation expression="&quot;Message Time Next Visible:  &quot; &amp; [Messages.TimeNextVisible]" stage="Time Next Visible" /></steps></stage><stage stageid="810ce834-70cd-44cd-b184-a6c707d5dcb7" name="Message Id" type="Data"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2c0ed8c8-31ea-49fa-8a2d-abb21a1cba52" name="Message Content" type="Data"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="64c0f72c-6467-40c5-ac7b-2ad7742bebd0" name="Message Pop Receipt" type="Data"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-195" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="965bdfe6-7514-43b8-9ccd-4e213638c01b" name="Dequeue Count" type="Data"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-195" y="75" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="96cfb028-50c3-468f-9e79-4cd46946be0c" name="Insertion Time" type="Data"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="36d77c86-ad6e-4ced-8c4c-d796c5c9b06e" name="Expiration Time" type="Data"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-195" y="135" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4bc051ef-072e-4124-aaff-d9d3b846ad66" name="Time Next Visible" type="Data"><subsheetid>d5b71469-0b9f-412a-8f6c-faf4a7bbf7ee</subsheetid><display x="-195" y="165" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="050bd352-9434-471c-9730-c975ab1f7170" name="Blueprism - Azure Queues REST API::Delete Message" type="Action"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><loginhibit onsuccess="true" /><display x="15" y="60" w="120" h="60" /><inputs><input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the Azure Queue" expr="[Global - Queue Name]" /><input type="password" name="Acces Key" friendlyname="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" expr="[Global - Access Key]" /><input type="text" name="Storage Account Name" friendlyname="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" expr="[Global - Stroage Account Name]" /><input type="text" name="Message Id" friendlyname="Message Id" expr="[Messages.MessageId]" /><input type="text" name="Message Pop Receipt" friendlyname="Message Pop Receipt" expr="[Messages.PopReceipt]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" friendlyname="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" friendlyname="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" friendlyname="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs><onsuccess>9767e17f-2e56-4647-af2a-23d9c7cbbf13</onsuccess><resource object="Blueprism - Azure Queues REST API" action="Delete Message" /></stage><stage stageid="91098c80-abb1-4e52-8b63-080296804d70" name="Messages" type="Collection"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="-195" y="45" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="eb50cd82-dfa0-422d-928b-f066df45ed48" name="HTTP Status Code" type="Data"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="-195" y="75" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="52bf6ffc-e099-4a9d-a524-1402f1d0d9b3" name="Response Headers" type="Collection"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="654f6fdd-1034-4467-9298-97229ed17186" name="Response Content" type="Data"><subsheetid>c7780dfd-0979-4aeb-b3cb-7479a2b37c63</subsheetid><display x="-195" y="135" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="136b2e42-76c2-4273-988d-4953deac5ea1" name="Messages" type="Collection"><display x="-195" y="15" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="b78cd9f1-bb21-4020-9b96-48b016cf7a25" name="Global Data Items" type="Block"><display x="-270" y="180" w="150" h="120" /><font family="Segoe UI" size="10" style="Regular" color="00FFFF" /></stage></process></process>
        <object id="98f99a73-e4ef-4b02-bb98-5f26efed1394" name="Blueprism - Azure Queues REST API" xmlns="http://www.blueprism.co.uk/product/process"><process name="Blueprism - Azure Queues REST API" version="1.0" bpversion="6.7.0.20116" narrative="This VBO provides a mechanism for interacting with Azure Queues via their exposed REST API. It includes actions for adding, peeking, retrieving, updating, and deleting messages." byrefcollection="true" type="object" runmode="Background"><appdef><element name="Application Root"><id>713bbf00-c707-4331-989e-aae0d7f2101a</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>120</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="f28de15f-cbad-406e-a77c-008151521aa2" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="09aa4686-20b5-4ca8-8518-afa3b1abb2d6" type="Normal" published="True"><name>Retrieve Messages</name><view><camerax>-185</camerax><cameray>38</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="49f72b25-56d2-414c-a007-e2a3f340c57f" type="Normal" published="True"><name>Retrieve Next Message</name><view><camerax>-174</camerax><cameray>84</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a457d454-e065-42c5-887d-68a724a8d0a9" type="Normal" published="True"><name>Peek Messages</name><view><camerax>-185</camerax><cameray>143</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="1c853bca-9e3a-4872-a133-e830d9d2c1b6" type="Normal" published="True"><name>Peek Next Message</name><view><camerax>-174</camerax><cameray>84</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="11c02554-dac4-4810-8cda-3db68ce8d47b" type="Normal" published="True"><name>Add Message</name><view><camerax>-182</camerax><cameray>71</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="29520adc-b0c0-40f0-8db2-0f5066302ec8" type="Normal" published="True"><name>Update Message</name><view><camerax>-182</camerax><cameray>71</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a8fafe28-6848-4797-89f4-268ef196c723" type="Normal" published="True"><name>Delete Message</name><view><camerax>-209</camerax><cameray>89</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="2909278d-cc31-40aa-8c18-d35da4174ff8" type="Normal" published="True"><name>Delete All Messages</name><view><camerax>-209</camerax><cameray>89</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="773d4ed6-fc82-4543-932a-8e076d7e9090" name="Start" type="Start"><loginhibit /><display x="15" y="-105" /><onsuccess>584ee30d-b889-4ac6-bd01-9c31dbeeffbe</onsuccess></stage><stage stageid="584ee30d-b889-4ac6-bd01-9c31dbeeffbe" name="End" type="End"><loginhibit /><display x="15" y="90" /></stage><stage stageid="18a99a3f-d5eb-40cb-8ca5-0206af5f7993" name="Stage1" type="ProcessInfo"><display x="-180" y="-105" w="180" h="90" /><references><reference>System.dll</reference><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference><reference>System.Core.dll</reference><reference>System.Xml.Linq.dll</reference><reference>System.Net.Http.dll</reference><reference>System.Web.dll</reference></references><imports><import>System</import><import>System.Drawing</import><import>System.Data</import><import>System.Collections.Generic</import><import>System.Linq</import><import>System.Collections.Specialized</import><import>System.Globalization</import><import>System.IO</import><import>System.Net</import><import>System.Security.Cryptography</import><import>System.Text</import><import>System.Xml.Linq</import><import>System.Text.RegularExpressions</import></imports><language>csharp</language><globalcode><![CDATA[]]></globalcode><code><![CDATA[public DataColumn[] GetOutputDataColumns()
{
	return new DataColumn[]
		{
			new DataColumn("MessageId", typeof(string)),
			new DataColumn("MessageText", typeof(string)),
			new DataColumn("PopReceipt", typeof(string)),
			new DataColumn("DequeueCount", typeof(string)),
			new DataColumn("InsertionTime", typeof(string)),
			new DataColumn("ExpirationTime", typeof(string)),
			new DataColumn("TimeNextVisible", typeof(string))
		};
}

public DataColumn[] GetResponseHeaderColumns()
{
	return new DataColumn[]
		{
			new DataColumn("Header", typeof(string)),
			new DataColumn("Value", typeof(string))
		};
}

public static bool IsBase64String(string s)
{
    s = s.Trim();
    return (s.Length % 4 == 0) && Regex.IsMatch(s, @"^[a-zA-Z0-9\+/]*={0,3}$", RegexOptions.None);

}

public HttpWebRequest GetWebRequest(string verb, string storageAccountName, string storageKey, string queueServiceEndpoint)
{
	// 1. construct HttpWebRequest including any payload if required
	var webRequest = (HttpWebRequest)WebRequest.Create(queueServiceEndpoint);
	webRequest.Method = verb;
	DateTime stamp = DateTime.UtcNow;
	webRequest.Headers.Add("x-ms-date", stamp.ToString("R", CultureInfo.InvariantCulture));
	webRequest.Headers.Add("x-ms-version", "2019-02-02");

	// 2. construct auth header and add to request
	webRequest.Headers.Add(HttpRequestHeader.Authorization, GetAuthorizationHeaderValue(storageAccountName, storageKey, stamp, webRequest));
	return webRequest;
}

public void ParseWebExceptionDetails(WebException wex, out string httpStatusCode, out DataTable responseHeaders, out string responseContent)
{
	// grab the http status code
	httpStatusCode = string.Format("{0} - {1}", ((int)((HttpWebResponse)wex.Response).StatusCode).ToString(), ((HttpWebResponse)wex.Response).StatusDescription);

	// load up the responseHeaders
	responseHeaders = new DataTable();
	responseHeaders.Columns.AddRange(GetResponseHeaderColumns());
	foreach (string k in wex.Response.Headers.Keys)
	{
		DataRow row = responseHeaders.NewRow();
		row["Header"] = k;
		row["Value"] = wex.Response.Headers.Get(k);
		responseHeaders.Rows.Add(row);
	}

	using (var sr = new StreamReader(wex.Response.GetResponseStream()))
	{
		// read in the response stream
		responseContent = sr.ReadToEnd();
	}
}

private string GetAuthorizationHeaderValue(string storageAccountName, string storageAccountKey, DateTime stamp, HttpWebRequest webRequest)
{
	string signature = "";

	// get header value string to be signed
	string messageSignature = string.Format("{0}\n\n\n{1}\n\n\n\n\n\n\n\n\n{2}{3}",
			  webRequest.Method,
			  (webRequest.Method == "GET" || webRequest.Method == "HEAD" || webRequest.Method == "DELETE") ? string.Empty
				: webRequest.ContentLength.ToString(),
			  GetCanonicalizedHeaders(webRequest),
			  GetCanonicalizedResource(webRequest.RequestUri, storageAccountName));

	// convert it to a byte array.
	byte[] SignatureBytes = Encoding.UTF8.GetBytes(messageSignature);

	// create the HMACSHA256 version of the storage key.
	HMACSHA256 SHA256 = new HMACSHA256(Convert.FromBase64String(storageAccountKey));

	// compute the hash of the SignatureBytes and convert it to a base64 string...then use it to build header value
	signature = string.Format("SharedKey {0}:{1}", storageAccountName, Convert.ToBase64String(SHA256.ComputeHash(SignatureBytes)));

	return signature;
}

private string GetCanonicalizedHeaders(HttpWebRequest webRequest)
{
	var headers = from key in webRequest.Headers.AllKeys
				  where key.StartsWith("x-ms-", StringComparison.OrdinalIgnoreCase)
				  orderby key
				  select new { Key = key.ToLowerInvariant(), Value = webRequest.Headers.GetValues(key) };

	StringBuilder sb = new StringBuilder();

	// Create the string in the expected standard or "canonicalized" format
	foreach (var kvp in headers)
	{
		StringBuilder headerBuilder = new StringBuilder(kvp.Key);
		char separator = ':';

		// Get the value for each header, strip out \r\n if found, then append it with the key.
		foreach (string headerValues in kvp.Value)
		{
			string trimmedValue = headerValues.TrimStart().Replace("\r\n", String.Empty);
			headerBuilder.Append(separator).Append(trimmedValue);

			// Set this to a comma; this will only be used 
			//   if there are multiple values for one of the headers.
			separator = ',';
		}
		sb.Append(headerBuilder.ToString()).Append("\n");
	}
	return sb.ToString();
}

private string GetCanonicalizedResource(Uri address, string storageAccountName)
{
	// The absolute path is "/" because for we're getting a list of containers.
	StringBuilder sb = new StringBuilder("/").Append(storageAccountName).Append(address.AbsolutePath);

	// Address.Query is the resource, such as "?comp=list".
	// This ends up with a NameValueCollection with 1 entry having key=comp, value=list.
	// It will have more entries if you have more query parameters.
	NameValueCollection values = System.Web.HttpUtility.ParseQueryString(address.Query);

	foreach (var item in values.AllKeys.OrderBy(k => k))
	{
		sb.Append('\n').Append(item).Append(':').Append(values[item]);
	}

	return sb.ToString();
}
]]></code></stage><stage stageid="77675fd6-b576-4efc-b854-3837fa93b212" name="Clean Up" type="SubSheetInfo"><subsheetid>f28de15f-cbad-406e-a77c-008151521aa2</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="ccbd73c4-1b4c-4ac2-9013-29b85f85888b" name="Start" type="Start"><subsheetid>f28de15f-cbad-406e-a77c-008151521aa2</subsheetid><loginhibit /><display x="15" y="-105" /><onsuccess>d0028452-6901-4907-88b2-d134bec3cf9e</onsuccess></stage><stage stageid="d0028452-6901-4907-88b2-d134bec3cf9e" name="End" type="End"><subsheetid>f28de15f-cbad-406e-a77c-008151521aa2</subsheetid><loginhibit /><display x="15" y="90" /></stage><stage stageid="72f73c5a-10d0-4ba7-b40a-7c5575e12bcb" name="Add Message" type="SubSheetInfo"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><narrative>Adds a message to the queue.</narrative><display x="-285" y="-105" w="330" h="90" /></stage><stage stageid="68bd7cf8-fb91-49c7-b9ee-2a3a12c36d49" name="Note1" type="Note"><subsheetid>f28de15f-cbad-406e-a77c-008151521aa2</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="380859c2-7191-426e-92a6-dbf70ab374f1" name="Note2" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="310fe34c-64aa-403c-aae5-7414029006d3" name="Message Content" type="Data"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><display x="-375" y="-15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="cb2d3240-3071-4129-ae43-9d0423af5b21" name="Retrieve Next Message" type="SubSheetInfo"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><narrative>Retrieves the next available message from the queue and makes it invisible to other consumers for the specified number of seconds.</narrative><display x="-285" y="-105" w="330" h="90" /></stage><stage stageid="26d9e967-fcbc-4696-9b61-d4ffc3b10779" name="Retrieve Messages" type="SubSheetInfo"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><narrative>Retrieves the specified number of messages from the queue and makes them invisible to other consumers for the specified number of seconds.</narrative><display x="-285" y="-105" w="330" h="90" /></stage><stage stageid="87d23f33-7c4f-4ed3-8764-9c10634a1847" name="Start" type="Start"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><loginhibit /><display x="-15" y="-135" /><inputs><input type="number" name="Visibility Timeout Seconds" narrative="Total number of seconds to keep the queue messages retieved invisible to prevent them being processed by another worker. Default is 30." stage="Visibility Timeout Seconds" /><input type="number" name="Number to Retrieve" narrative="The number of messages to retrieve. Can be a number between 1 and 32. Default is 32." stage="Number to Retrieve" /><input type="text" name="Queue Name" narrative="The name of the Azure Queue" stage="Queue Name" /><input type="password" name="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" stage="Acces Key" /><input type="text" name="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" stage="Storage Account Name" /></inputs><onsuccess>cf8a0e43-6f30-4d90-8797-08fbca77331c</onsuccess></stage><stage stageid="37258156-4f00-4c46-8275-f9ae29da009f" name="End" type="End"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><loginhibit /><display x="-15" y="30" /><outputs><output type="flag" name="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="collection" name="Messages" narrative="Messages retrieved from the queue" stage="Messages" /><output type="text" name="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs></stage><stage stageid="cf8a0e43-6f30-4d90-8797-08fbca77331c" name="Retrieve Messages" type="Code"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><loginhibit /><display x="-15" y="-60" w="90" h="60" /><inputs><input type="number" name="visibilityTimeoutSeconds" expr="[Visibility Timeout Seconds]" /><input type="number" name="numberToRetrieve" expr="[Number to Retrieve]" /><input type="text" name="queueName" expr="[Queue Name]" /><input type="password" name="storageKey" expr="[Acces Key]" /><input type="text" name="storageAccountName" expr="[Storage Account Name]" /></inputs><outputs><output type="flag" name="success" stage="Success" /><output type="text" name="result" stage="Result" /><output type="collection" name="output" stage="Messages" /><output type="collection" name="responseHeaders" stage="Response Headers" /><output type="text" name="httpStatusCode" stage="HTTP Status Code" /><output type="text" name="responseContent" stage="Response Content" /></outputs><onsuccess>37258156-4f00-4c46-8275-f9ae29da009f</onsuccess><code><![CDATA[success = true;
result = string.Empty;
output = new DataTable();
responseHeaders = new DataTable();
httpStatusCode = string.Empty;
responseContent = string.Empty;

try
{
	// construct the uri and create the webRequest object
	string queueServiceEndpoint = string.Format("https://{0}.queue.core.windows.net/{1}/messages?numofmessages={2}&visibilitytimeout={3}", storageAccountName, queueName, numberToRetrieve, visibilityTimeoutSeconds);
	HttpWebRequest webRequest = GetWebRequest("GET", storageAccountName, storageKey, queueServiceEndpoint);

	// get the response from the webRequest and process it
	using (HttpWebResponse response = (HttpWebResponse)webRequest.GetResponse())
	{
		// grab the http status code
		httpStatusCode = string.Format("{0} - {1}", ((int)response.StatusCode).ToString(), response.StatusCode.ToString());

		// prep the output structure
		output.Columns.AddRange(GetOutputDataColumns());

		// prep the responseHeaders structure
		responseHeaders.Columns.AddRange(GetResponseHeaderColumns());

		// load up the responseHeaders
		foreach (string k in response.Headers.Keys)
		{
			DataRow row = responseHeaders.NewRow();
			row["Header"] = k;
			row["Value"] = response.Headers.Get(k);
			responseHeaders.Rows.Add(row);
		}

		using (var sr = new StreamReader(response.GetResponseStream()))
		{
			// read in the response stream
			responseContent = sr.ReadToEnd();
			success = true;

			// then parse the response xml and use it to load up the output
			XDocument xdoc = XDocument.Parse(responseContent);

			DataRow row;
			foreach (var xelement in xdoc.Descendants("QueueMessage"))
			{
				row = output.NewRow();
				row["MessageId"] = xelement.Element("MessageId").Value;
				if (IsBase64String(xelement.Element("MessageText").Value))
				{
					row["MessageText"] = Encoding.UTF8.GetString(Convert.FromBase64String(xelement.Element("MessageText").Value));
				}
				else
				{
					row["MessageText"] = xelement.Element("MessageText").Value;
				}
				row["PopReceipt"] = xelement.Element("PopReceipt").Value;
				row["InsertionTime"] = xelement.Element("InsertionTime").Value;
				row["ExpirationTime"] = xelement.Element("ExpirationTime").Value;
				row["TimeNextVisible"] = xelement.Element("TimeNextVisible").Value;
				// The DequeueCount element is returned in the response body only if the queue was created with version 2009-09-19 of the Queue service.
				row["DequeueCount"] = xelement.Element("DequeueCount") == null ? string.Empty : xelement.Element("DequeueCount").Value;
				output.Rows.Add(row);
			}
		}
	}
}
catch (WebException wex)
{
	result = wex.Message;
	success = false;

	ParseWebExceptionDetails(wex, out httpStatusCode, out responseHeaders, out responseContent);
}
catch (Exception ex)
{
	result = ex.Message;
	success = false;
}
]]></code></stage><stage stageid="ee4b41da-b9f1-4695-8b37-ec9471c3127f" name="Success" type="Data"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c793644d-cdef-4bfe-8d9b-e1faa7524cbe" name="Result" type="Data"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="adb155eb-2455-4e63-a8d1-7d65c08ff00a" name="Number to Retrieve" type="Data"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><narrative>The number of messages to retrieve. Can be a number between 1 and 32. Default is 32.</narrative><display x="-375" y="15" w="120" h="30" /><datatype>number</datatype><initialvalue>32</initialvalue><private /><alwaysinit /></stage><stage stageid="01bb0e87-e0e3-4c7d-b312-e78d8a2fbce8" name="Messages" type="Collection"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><loginhibit /><display x="-195" y="135" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="e2c5745c-ce21-45e9-9ba9-ef1bce34b075" name="Input Data Items" type="Block"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><loginhibit /><display x="-450" y="-45" w="150" h="180" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="bfe6cb60-f8e5-42fe-a082-48b4373edc7d" name="Output Data Items" type="Block"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><loginhibit /><display x="-270" y="-45" w="150" h="210" /><font family="Segoe UI" size="10" style="Regular" color="800000" /></stage><stage stageid="108f2dbe-86df-4ac9-a373-10182eca084c" name="Delete Message" type="SubSheetInfo"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><narrative>Deletes a message from the queue.</narrative><display x="-285" y="-105" w="330" h="90" /></stage><stage stageid="cc437a6b-f9b7-4be5-b002-cf1a3df5218c" name="Input Data Items" type="Block"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><loginhibit /><display x="-450" y="-45" w="150" h="180" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="8cf2900f-d538-4ef3-adcc-b41bcdc23da4" name="Message Id" type="Data"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><display x="-375" y="-15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6fc41fae-209e-45cd-8d0a-aaa3f93f0cbd" name="Message Pop Receipt" type="Data"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><display x="-375" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c46725e1-d0ee-4ec1-9490-7ae972c15e8e" name="Success" type="Data"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="38abada9-3123-46f1-8512-d2831897c516" name="Result" type="Data"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7dc48f65-fec7-41f0-839e-2a28a822e099" name="Input Data Items" type="Block"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><loginhibit /><display x="-450" y="-45" w="150" h="180" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="bc8d79c3-9c38-4e22-84db-042be7471f8c" name="Output Data Items" type="Block"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><loginhibit /><display x="-270" y="-45" w="150" h="180" /><font family="Segoe UI" size="10" style="Regular" color="800000" /></stage><stage stageid="17291b1c-d916-4529-9296-26a6ab37c3e5" name="Visibility Timeout Seconds" type="Data"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><narrative>Total number of seconds to keep the queue messages retieved invisible to prevent them being processed by another worker. Default is 30.</narrative><display x="-375" y="-15" w="120" h="30" /><datatype>number</datatype><initialvalue>30</initialvalue><private /><alwaysinit /></stage><stage stageid="713f8652-8704-4368-89d0-c6adfd680c48" name="Response Headers" type="Collection"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><display x="-195" y="75" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="7f2091b5-c99e-40ed-ab26-026fb9424c26" name="HTTP Status Code" type="Data"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><display x="-195" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="cf13216d-dc5e-4b9c-b20d-71dcbae49969" name="Response Content" type="Data"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ea38536b-a5d1-481b-a711-8bfad068a55a" name="Queue Name" type="Data"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><display x="-375" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2f20eaa7-5d24-4ed4-932e-5e627eae86ad" name="Acces Key" type="Data"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><display x="-375" y="75" w="120" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="a8ea7a1d-3ac3-4cbb-8e73-6229ba5ea562" name="Storage Account Name" type="Data"><subsheetid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</subsheetid><display x="-375" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="de51f31c-d3c2-4b56-9c72-dbaf21842e2a" name="Start" type="Start"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><loginhibit /><display x="-15" y="-135" /><inputs><input type="number" name="Visibility Timeout Seconds" narrative="Total number of seconds to keep the queue messages retieved invisible to prevent them being processed by another worker. Default is 30." stage="Visibility Timeout Seconds" /><input type="text" name="Queue Name" narrative="The name of the Azure Queue" stage="Queue Name" /><input type="password" name="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" stage="Acces Key" /><input type="text" name="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" stage="Storage Account Name" /></inputs><onsuccess>ab36d51a-eaa3-4a76-9ba3-96ba75aa779e</onsuccess></stage><stage stageid="8f560cbe-0144-47b7-aa5e-119303fe4384" name="End" type="End"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><loginhibit /><display x="-15" y="15" /><outputs><output type="flag" name="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="collection" name="Messages" narrative="Messages retrieved from the queue" stage="Messages" /><output type="text" name="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs></stage><stage stageid="c96d323c-70e5-48fe-a682-b8b9614f16ac" name="Success" type="Data"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7bfd5bc8-55f2-44db-b155-cb57109d83b7" name="Result" type="Data"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="821cab9f-0322-479e-8d48-717f9ca058ea" name="Messages" type="Collection"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><loginhibit /><display x="-195" y="135" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="5898075f-0af4-404a-81cd-fc72211f92b9" name="Input Data Items" type="Block"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><loginhibit /><display x="-450" y="-45" w="150" h="150" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="3c1bd47a-4565-46b6-ad7f-17d598ef27e7" name="Output Data Items" type="Block"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><loginhibit /><display x="-270" y="-45" w="150" h="210" /><font family="Segoe UI" size="10" style="Regular" color="800000" /></stage><stage stageid="434529f9-68f5-40c6-a3a8-13a2519d46d0" name="Visibility Timeout Seconds" type="Data"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><narrative>Total number of seconds to keep the queue messages retieved invisible to prevent them being processed by another worker. Default is 30.</narrative><display x="-375" y="-15" w="120" h="30" /><datatype>number</datatype><initialvalue>30</initialvalue><private /><alwaysinit /></stage><stage stageid="860f78d2-dcae-411f-94a3-8d601c09822b" name="Response Headers" type="Collection"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><display x="-195" y="75" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="855e66b2-2b9c-44c9-9680-3f8514b70534" name="HTTP Status Code" type="Data"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><display x="-195" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="335fcfea-55c9-40ce-89b9-9ed7ac747cce" name="Response Content" type="Data"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="55977536-e54c-49ca-9b15-285d39063c08" name="Queue Name" type="Data"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><display x="-375" y="75" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ccadca2f-3e6d-4229-b36a-b88fe4e3d193" name="Acces Key" type="Data"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><display x="-375" y="45" w="120" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="57f481ae-e1e3-463e-b33a-3004a241b7ed" name="Storage Account Name" type="Data"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><display x="-375" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ab36d51a-eaa3-4a76-9ba3-96ba75aa779e" name="Retrieve Messages" type="SubSheet"><subsheetid>49f72b25-56d2-414c-a007-e2a3f340c57f</subsheetid><loginhibit /><display x="-15" y="-60" w="90" h="60" /><inputs><input type="number" name="Visibility Timeout Seconds" friendlyname="Visibility Timeout Seconds" narrative="Total number of seconds to keep the queue messages retieved invisible to prevent them being processed by another worker. Default is 30." expr="[Visibility Timeout Seconds]" /><input type="number" name="Number to Retrieve" friendlyname="Number to Retrieve" narrative="The number of messages to retrieve. Can be a number between 1 and 32. Default is 32." expr="1" /><input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the Azure Queue" expr="[Queue Name]" /><input type="password" name="Acces Key" friendlyname="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" expr="[Acces Key]" /><input type="text" name="Storage Account Name" friendlyname="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" expr="[Storage Account Name]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" friendlyname="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="collection" name="Messages" friendlyname="Messages" narrative="Messages retrieved from the queue" stage="Messages" /><output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" friendlyname="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" friendlyname="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs><onsuccess>8f560cbe-0144-47b7-aa5e-119303fe4384</onsuccess><processid>09aa4686-20b5-4ca8-8518-afa3b1abb2d6</processid></stage><stage stageid="a79e64e7-2e5c-4a40-b7ad-ad3511830d00" name="Start" type="Start"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><loginhibit /><display x="-15" y="-135" /><inputs><input type="text" name="Queue Name" narrative="The name of the Azure Queue" stage="Queue Name" /><input type="password" name="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" stage="Acces Key" /><input type="text" name="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" stage="Storage Account Name" /><input type="text" name="Message Id" narrative="Required. The message ID, a GUID that identifies the message in the queue." stage="Message Id" /><input type="text" name="Message Pop Receipt" narrative="Required. Specifies the valid pop receipt value returned from an earlier call to the Get Messages or Update Message operation." stage="Message Pop Receipt" /></inputs><onsuccess>41fb8f8b-ef0c-4490-b3db-454307d1c51d</onsuccess></stage><stage stageid="2c8a1b75-07a1-4ea5-aab3-5d82f48b92f7" name="Queue Name" type="Data"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><display x="-375" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="cbe23111-6999-47df-ab16-e0c9feccf6f8" name="Acces Key" type="Data"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><display x="-375" y="75" w="120" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="3f9e5a09-7b9a-4bba-91fc-08ad167da2d9" name="Storage Account Name" type="Data"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><display x="-375" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="41fb8f8b-ef0c-4490-b3db-454307d1c51d" name="Delete Message" type="Code"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><loginhibit /><display x="-15" y="-60" w="90" h="60" /><inputs><input type="text" name="messageId" expr="[Message Id]" /><input type="text" name="popReceipt" expr="[Message Pop Receipt]" /><input type="text" name="queueName" expr="[Queue Name]" /><input type="password" name="storageKey" expr="[Acces Key]" /><input type="text" name="storageAccountName" expr="[Storage Account Name]" /></inputs><outputs><output type="flag" name="success" stage="Success" /><output type="text" name="result" stage="Result" /><output type="collection" name="responseHeaders" stage="Response Headers" /><output type="text" name="httpStatusCode" stage="HTTP Status Code" /><output type="text" name="responseContent" stage="Response Content" /></outputs><onsuccess>75dc6004-78cc-4bb5-96d0-dc390aedf4ad</onsuccess><code><![CDATA[success = true;
result = string.Empty;
responseHeaders = new DataTable();
httpStatusCode = string.Empty;
responseContent = string.Empty;

try
{
	// construct the uri and create the webRequest object
	string queueServiceEndpoint = string.Format("https://{0}.queue.core.windows.net/{1}/messages/{2}?popreceipt={3}", storageAccountName, queueName, messageId, popReceipt);
	HttpWebRequest webRequest = GetWebRequest("DELETE", storageAccountName, storageKey, queueServiceEndpoint);

	// get the response from the webRequest and process it
	using (HttpWebResponse response = (HttpWebResponse)webRequest.GetResponse())
	{
		// grab the http status code
		httpStatusCode = string.Format("{0} - {1}", ((int)response.StatusCode).ToString(), response.StatusCode.ToString());

		// prep the responseHeaders structure
		responseHeaders.Columns.AddRange(GetResponseHeaderColumns());

		// load up the responseHeaders
		foreach (string k in response.Headers.Keys)
		{
			DataRow row = responseHeaders.NewRow();
			row["Header"] = k;
			row["Value"] = response.Headers.Get(k);
			responseHeaders.Rows.Add(row);
		}

		using (var sr = new StreamReader(response.GetResponseStream()))
		{
			// read in the response stream
			responseContent = sr.ReadToEnd();
			success = true;
		}
	}
}
catch (WebException wex)
{
	result = wex.Message;
	success = false;

	ParseWebExceptionDetails(wex, out httpStatusCode, out responseHeaders, out responseContent);
}
catch (Exception ex)
{
	result = ex.Message;
	success = false;
}
]]></code></stage><stage stageid="856c148b-d186-4bdc-8129-feab0896f2c9" name="Response Headers" type="Collection"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><display x="-195" y="75" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="be02d1a8-7265-49ca-9f6f-9c31b43f2c71" name="HTTP Status Code" type="Data"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><display x="-195" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="66f1c8a6-bf82-4978-82f2-f11c58390315" name="Response Content" type="Data"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="75dc6004-78cc-4bb5-96d0-dc390aedf4ad" name="End" type="End"><subsheetid>a8fafe28-6848-4797-89f4-268ef196c723</subsheetid><loginhibit /><display x="-15" y="15" /><outputs><output type="flag" name="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="text" name="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs></stage><stage stageid="ac1c981b-b09c-44a1-8426-6501e75dc4fb" name="Start" type="Start"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><loginhibit /><display x="0" y="-135" /><inputs><input type="number" name="Visibility Timeout Seconds" narrative="Total number of seconds to keep the queue messages retieved invisible to prevent them being processed by another worker. Default is 30." stage="Visibility Timeout Seconds" /><input type="text" name="Message Content" narrative="The content of the message" stage="Message Content" /><input type="text" name="Queue Name" narrative="The name of the Azure Queue" stage="Queue Name" /><input type="password" name="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" stage="Acces Key" /><input type="text" name="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" stage="Storage Account Name" /></inputs><onsuccess>166975a7-9be8-41e4-a3d0-589fbceaef5d</onsuccess></stage><stage stageid="86218387-226e-49aa-ac71-1bb20e8a66e2" name="Queue Name" type="Data"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><display x="-375" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d1f9f86f-a312-4e55-9475-e6155f4a90ee" name="Acces Key" type="Data"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><display x="-375" y="75" w="120" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="5d80d386-8545-44e9-b34c-e2e32f55125f" name="Storage Account Name" type="Data"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><display x="-375" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4b13f8b7-3cbb-4f68-a018-9a918b530d97" name="Visibility Timeout Seconds" type="Data"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><display x="-375" y="15" w="120" h="30" /><datatype>number</datatype><initialvalue>30</initialvalue><private /><alwaysinit /></stage><stage stageid="99672200-1d23-4d24-9cac-19b65119aa1e" name="Success" type="Data"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="44758c54-72ef-4ba1-9a6c-cccee4483016" name="Result" type="Data"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a62934d3-7032-4d4e-9698-5d79ead11daf" name="Messages" type="Collection"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><loginhibit /><display x="-195" y="135" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="670e737d-9928-4a14-bdbf-ca6444cf9689" name="Output Data Items" type="Block"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><loginhibit /><display x="-270" y="-45" w="150" h="210" /><font family="Segoe UI" size="10" style="Regular" color="800000" /></stage><stage stageid="3f015b3f-210e-438a-93fa-6eba4a393e18" name="Response Headers" type="Collection"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><display x="-195" y="75" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="222aba09-adce-4153-91a4-a1318857f236" name="HTTP Status Code" type="Data"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><display x="-195" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="868d0660-06fd-4f59-96df-28a96be6080a" name="Response Content" type="Data"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="82f189f1-9662-4511-9cb6-dbe615d975f3" name="End" type="End"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><loginhibit /><display x="0" y="15" /><outputs><output type="flag" name="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="collection" name="Messages" narrative="Messages retrieved from the queue" stage="Messages" /><output type="text" name="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs></stage><stage stageid="166975a7-9be8-41e4-a3d0-589fbceaef5d" name="Add Message" type="Code"><subsheetid>11c02554-dac4-4810-8cda-3db68ce8d47b</subsheetid><loginhibit /><display x="0" y="-60" w="90" h="60" /><inputs><input type="number" name="visibilityTimeoutSeconds" expr="[Visibility Timeout Seconds]" /><input type="text" name="messageContent" expr="[Message Content]" /><input type="text" name="queueName" expr="[Queue Name]" /><input type="password" name="storageKey" expr="[Acces Key]" /><input type="text" name="storageAccountName" expr="[Storage Account Name]" /></inputs><outputs><output type="flag" name="success" stage="Success" /><output type="text" name="result" stage="Result" /><output type="collection" name="output" stage="Messages" /><output type="collection" name="responseHeaders" stage="Response Headers" /><output type="text" name="httpStatusCode" stage="HTTP Status Code" /><output type="text" name="responseContent" stage="Response Content" /></outputs><onsuccess>82f189f1-9662-4511-9cb6-dbe615d975f3</onsuccess><code><![CDATA[success = true;
result = string.Empty;
output = new DataTable();
responseHeaders = new DataTable();
httpStatusCode = string.Empty;
responseContent = string.Empty;

try
{
	// construct the uri and create the webRequest object
	string queueServiceEndpoint = string.Format("https://{0}.queue.core.windows.net/{1}/messages?visibilitytimeout={2}", storageAccountName, queueName, visibilityTimeoutSeconds);
	HttpWebRequest webRequest = GetWebRequest("POST", storageAccountName, storageKey, queueServiceEndpoint);

	// wrap the message content in the expected xml structure, convert it to byte[], and set content length
	// - per Microsoft (https://docs.microsoft.com/en-us/rest/api/storageservices/put-message)
	//   "A message must be in a format that can be included in an XML request with UTF-8 encoding. To include markup in the message, 
	//    the contents of the message must either be XML-escaped or Base64-encode. Any XML markup in the message that is not escaped 
	//    or encoded will be removed before the message is added to the queue."
	string postData = string.Format("<QueueMessage><MessageText>{0}</MessageText></QueueMessage>", Convert.ToBase64String(Encoding.UTF8.GetBytes(messageContent)));
	byte[] bytes = Encoding.UTF8.GetBytes(postData);
	webRequest.ContentLength = bytes.Length;
	
	// get the request stream and write the post data to it
	Stream dataStream = webRequest.GetRequestStream();
	dataStream.Write(bytes, 0, bytes.Length);
	dataStream.Close();

	// get the response from the webRequest and process it
	using (HttpWebResponse response = (HttpWebResponse)webRequest.GetResponse())
	{
		// grab the http status code
		httpStatusCode = string.Format("{0} - {1}", ((int)response.StatusCode).ToString(), response.StatusCode.ToString());

		// prep the output structure
		output.Columns.AddRange(GetOutputDataColumns());

		// prep the responseHeaders structure
		responseHeaders.Columns.AddRange(GetResponseHeaderColumns());

		// load up the responseHeaders
		foreach (string k in response.Headers.Keys)
		{
			DataRow row = responseHeaders.NewRow();
			row["Header"] = k;
			row["Value"] = response.Headers.Get(k);
			responseHeaders.Rows.Add(row);
		}

		using (var sr = new StreamReader(response.GetResponseStream()))
		{
			// read in the response stream
			responseContent = sr.ReadToEnd();
			success = true;

			// then parse the response xml and use it to load up the output
			XDocument xdoc = XDocument.Parse(responseContent);

			DataRow row;
			foreach (var xelement in xdoc.Descendants("QueueMessage"))
			{
				row = output.NewRow();
				row["MessageId"] = xelement.Element("MessageId").Value;
				row["MessageText"] = messageContent;
				row["PopReceipt"] = xelement.Element("PopReceipt").Value;
				row["DequeueCount"] = "0";
				row["InsertionTime"] = xelement.Element("InsertionTime").Value;
				row["ExpirationTime"] = xelement.Element("ExpirationTime").Value;
				row["TimeNextVisible"] = xelement.Element("TimeNextVisible").Value;
				output.Rows.Add(row);
			}
		}
	}
}
catch (WebException wex)
{
	result = wex.Message;
	success = false;

	ParseWebExceptionDetails(wex, out httpStatusCode, out responseHeaders, out responseContent);
}
catch (Exception ex)
{
	result = ex.Message;
	success = false;
}
]]></code></stage><stage stageid="eb8923ed-58d4-4e81-861a-9d2bc1fe9b06" name="Peek Messages" type="SubSheetInfo"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><narrative>Retrieves the specified number of messages from the queue but does not alter their visibility so they remain available for other consumers to work.</narrative><display x="-285" y="-105" w="330" h="90" /></stage><stage stageid="68e994c4-6134-426e-bf0c-ef7e6c10567c" name="Start" type="Start"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><loginhibit /><display x="-15" y="-135" /><inputs><input type="number" name="Number to Retrieve" narrative="The number of messages to retrieve. Can be a number between 1 and 32. Default is 32." stage="Number to Retrieve" /><input type="text" name="Queue Name" narrative="The name of the Azure Queue" stage="Queue Name" /><input type="password" name="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" stage="Acces Key" /><input type="text" name="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" stage="Storage Account Name" /></inputs><onsuccess>1b0bf83c-c196-47b4-b7de-ba9406321224</onsuccess></stage><stage stageid="7b39a2e9-f41e-4f7a-a772-d988fab78eb7" name="End" type="End"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><loginhibit /><display x="-15" y="30" /><outputs><output type="flag" name="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="collection" name="Messages" narrative="Messages retrieved from the queue" stage="Messages" /><output type="text" name="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs></stage><stage stageid="1b0bf83c-c196-47b4-b7de-ba9406321224" name="Peek Messages" type="Code"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><loginhibit /><display x="-15" y="-60" w="90" h="60" /><inputs><input type="number" name="numberToRetrieve" expr="[Number to Retrieve]" /><input type="text" name="queueName" expr="[Queue Name]" /><input type="password" name="storageKey" expr="[Acces Key]" /><input type="text" name="storageAccountName" expr="[Storage Account Name]" /></inputs><outputs><output type="flag" name="success" stage="Success" /><output type="text" name="result" stage="Result" /><output type="collection" name="output" stage="Messages" /><output type="collection" name="responseHeaders" stage="Response Headers" /><output type="text" name="httpStatusCode" stage="HTTP Status Code" /><output type="text" name="responseContent" stage="Response Content" /></outputs><onsuccess>7b39a2e9-f41e-4f7a-a772-d988fab78eb7</onsuccess><code><![CDATA[success = true;
result = string.Empty;
output = new DataTable();
responseHeaders = new DataTable();
httpStatusCode = string.Empty;
responseContent = string.Empty;

try
{
	// construct the uri and create the webRequest object
	string queueServiceEndpoint = string.Format("https://{0}.queue.core.windows.net/{1}/messages?peekonly=true&numofmessages={2}", storageAccountName, queueName, numberToRetrieve);
	HttpWebRequest webRequest = GetWebRequest("GET", storageAccountName, storageKey, queueServiceEndpoint);

	// get the response from the webRequest and process it
	using (HttpWebResponse response = (HttpWebResponse)webRequest.GetResponse())
	{
		// grab the http status code
		httpStatusCode = string.Format("{0} - {1}", ((int)response.StatusCode).ToString(), response.StatusCode.ToString());

		// prep the output structure
		output.Columns.AddRange(GetOutputDataColumns());

		// prep the responseHeaders structure
		responseHeaders.Columns.AddRange(GetResponseHeaderColumns());

		// load up the responseHeaders
		foreach (string k in response.Headers.Keys)
		{
			DataRow row = responseHeaders.NewRow();
			row["Header"] = k;
			row["Value"] = response.Headers.Get(k);
			responseHeaders.Rows.Add(row);
		}

		using (var sr = new StreamReader(response.GetResponseStream()))
		{
			// read in the response stream
			responseContent = sr.ReadToEnd();
			success = true;

			// then parse the response xml and use it to load up the output
			XDocument xdoc = XDocument.Parse(responseContent);

			DataRow row;
			foreach (var xelement in xdoc.Descendants("QueueMessage"))
			{
				row = output.NewRow();
				row["MessageId"] = xelement.Element("MessageId").Value;
				if (IsBase64String(xelement.Element("MessageText").Value))
				{
					row["MessageText"] = Encoding.UTF8.GetString(Convert.FromBase64String(xelement.Element("MessageText").Value));
				}
				else
				{
					row["MessageText"] = xelement.Element("MessageText").Value;
				}
				row["PopReceipt"] = xelement.Element("PopReceipt").Value;
				row["InsertionTime"] = xelement.Element("InsertionTime").Value;
				row["ExpirationTime"] = xelement.Element("ExpirationTime").Value;
				row["TimeNextVisible"] = xelement.Element("TimeNextVisible").Value;
				// The DequeueCount element is returned in the response body only if the queue was created with version 2009-09-19 of the Queue service.
				row["DequeueCount"] = xelement.Element("DequeueCount") == null ? string.Empty : xelement.Element("DequeueCount").Value;
				output.Rows.Add(row);
			}
		}
	}
}
catch (WebException wex)
{
	result = wex.Message;
	success = false;

	ParseWebExceptionDetails(wex, out httpStatusCode, out responseHeaders, out responseContent);
}
catch (Exception ex)
{
	result = ex.Message;
	success = false;
}
]]></code></stage><stage stageid="0904d82a-fff6-457f-be87-36fe2450dbd7" name="Success" type="Data"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a649e40d-cae3-4a51-838a-85fd251d9682" name="Result" type="Data"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5d825f28-8f57-4094-a9d6-a744bc2b3b5e" name="Number to Retrieve" type="Data"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><narrative>The number of messages to retrieve. Can be a number between 1 and 32. Default is 32.</narrative><display x="-375" y="-15" w="120" h="30" /><datatype>number</datatype><initialvalue>32</initialvalue><private /><alwaysinit /></stage><stage stageid="2872c463-f06b-4a55-adb9-4d0fecd1b5df" name="Messages" type="Collection"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><loginhibit /><display x="-195" y="135" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="cfa0429a-5750-4d49-87bc-64f2f96e5fae" name="Input Data Items" type="Block"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><loginhibit /><display x="-450" y="-45" w="150" h="150" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="63e383ba-cb27-4403-9d37-e2971a7ff618" name="Output Data Items" type="Block"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><loginhibit /><display x="-270" y="-45" w="150" h="210" /><font family="Segoe UI" size="10" style="Regular" color="800000" /></stage><stage stageid="f4872aa6-8358-4495-a618-f06942a6cdb9" name="Response Headers" type="Collection"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><display x="-195" y="75" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="469cd321-41ee-40f8-8e0f-8a66833a1307" name="HTTP Status Code" type="Data"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><display x="-195" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="920b7406-0f66-4ff4-b414-cfede0010dd8" name="Response Content" type="Data"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="883d6f25-0725-45a9-828d-1508ae95f26e" name="Queue Name" type="Data"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><display x="-375" y="75" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8ab97d91-7166-4d09-a3a1-30ff35e31593" name="Acces Key" type="Data"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><display x="-375" y="45" w="120" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="dea9ab75-ac54-4577-a725-aaf4fa9642fe" name="Storage Account Name" type="Data"><subsheetid>a457d454-e065-42c5-887d-68a724a8d0a9</subsheetid><display x="-375" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4ec86e3c-d0e4-402b-ba17-762536e4ebb8" name="Peek Next Message" type="SubSheetInfo"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><narrative>Retrieves the next available message from the queue but does not alter its visibility so it remains available for other consumers to work.</narrative><display x="-285" y="-105" w="330" h="90" /></stage><stage stageid="6fe17835-24cf-46db-950c-fca1e0e90d60" name="Start" type="Start"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><loginhibit /><display x="-15" y="-135" /><inputs><input type="text" name="Queue Name" narrative="The name of the Azure Queue" stage="Queue Name" /><input type="password" name="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" stage="Acces Key" /><input type="text" name="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" stage="Storage Account Name" /></inputs><onsuccess>def2ffb4-170c-40e4-872d-2357ac3fcbeb</onsuccess></stage><stage stageid="0e6db835-ff33-4f72-9e6d-cceaa12ae621" name="End" type="End"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><loginhibit /><display x="-15" y="15" /><outputs><output type="flag" name="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="collection" name="Messages" narrative="Messages retrieved from the queue" stage="Messages" /><output type="text" name="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs></stage><stage stageid="bd855a66-33ad-4378-987a-5cee61c559bc" name="Success" type="Data"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="79c2b725-cb98-4272-bc16-3957c98367b1" name="Result" type="Data"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8d0c1a95-063d-440a-b681-07a41a337190" name="Messages" type="Collection"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><loginhibit /><display x="-195" y="135" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="327e6f35-2d17-4a03-a39c-390fc6b488e4" name="Input Data Items" type="Block"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><loginhibit /><display x="-450" y="-45" w="150" h="150" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="78bdcc67-920c-4d1b-b432-7022ae78ddef" name="Output Data Items" type="Block"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><loginhibit /><display x="-270" y="-45" w="150" h="210" /><font family="Segoe UI" size="10" style="Regular" color="800000" /></stage><stage stageid="854d5350-69bd-494f-9e66-89d79cc0e97d" name="Response Headers" type="Collection"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><display x="-195" y="75" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="66f23133-b9a7-4423-8c6d-01cd4ea20750" name="HTTP Status Code" type="Data"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><display x="-195" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="af4d770b-dbd5-42f6-b3cf-3b4ee0d1845b" name="Response Content" type="Data"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2c7ef71a-5b90-4d87-8536-cfb41b222b69" name="Queue Name" type="Data"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><display x="-375" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="cdc258a9-a696-4d61-9e5b-a0efe2e4c6c9" name="Acces Key" type="Data"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><display x="-375" y="15" w="120" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="13427615-cab3-41cb-9a94-5f2d9568d34f" name="Storage Account Name" type="Data"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><display x="-375" y="-15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="def2ffb4-170c-40e4-872d-2357ac3fcbeb" name="Peek Messages" type="SubSheet"><subsheetid>1c853bca-9e3a-4872-a133-e830d9d2c1b6</subsheetid><loginhibit /><display x="-15" y="-60" w="90" h="60" /><inputs><input type="number" name="Number to Retrieve" friendlyname="Number to Retrieve" narrative="The number of messages to retrieve. Can be a number between 1 and 32. Default is 32." expr="1" /><input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the Azure Queue" expr="[Queue Name]" /><input type="password" name="Acces Key" friendlyname="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" expr="[Acces Key]" /><input type="text" name="Storage Account Name" friendlyname="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" expr="[Storage Account Name]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" friendlyname="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="collection" name="Messages" friendlyname="Messages" narrative="Messages retrieved from the queue" stage="Messages" /><output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" friendlyname="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" friendlyname="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs><onsuccess>0e6db835-ff33-4f72-9e6d-cceaa12ae621</onsuccess><processid>a457d454-e065-42c5-887d-68a724a8d0a9</processid></stage><stage stageid="8ffe00e3-936f-4e2a-a3cb-75c040a963c2" name="Delete All Messages" type="SubSheetInfo"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><narrative>Deletes all messages from the queue.</narrative><display x="-285" y="-105" w="330" h="90" /></stage><stage stageid="53062f00-4349-41e8-8c1e-096cbd2329f4" name="Success" type="Data"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1bbdd3ce-d65f-483d-ba25-d4349ed625b6" name="Result" type="Data"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3681b772-7399-4e54-9d19-1c1127d0c43b" name="Input Data Items" type="Block"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><loginhibit /><display x="-450" y="-45" w="150" h="180" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="2b9954e1-973c-4b74-8f80-95d70fe44170" name="Output Data Items" type="Block"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><loginhibit /><display x="-270" y="-45" w="150" h="180" /><font family="Segoe UI" size="10" style="Regular" color="800000" /></stage><stage stageid="3400e602-ca51-45e9-a953-b6907d1a338f" name="Start" type="Start"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><loginhibit /><display x="-15" y="-135" /><inputs><input type="text" name="Queue Name" narrative="The name of the Azure Queue" stage="Queue Name" /><input type="password" name="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" stage="Acces Key" /><input type="text" name="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" stage="Storage Account Name" /></inputs><onsuccess>d57d6faa-cae7-4c28-be88-77c42c9b250b</onsuccess></stage><stage stageid="570a4f63-2962-4413-9d56-2deb5621d598" name="Queue Name" type="Data"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><display x="-375" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="123125c3-931e-45d8-b335-4563165a2a16" name="Acces Key" type="Data"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><display x="-375" y="15" w="120" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="c7fee16f-91dd-4957-8edb-1346a455e68e" name="Storage Account Name" type="Data"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><display x="-375" y="-15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d57d6faa-cae7-4c28-be88-77c42c9b250b" name="Delete All Messages" type="Code"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><loginhibit /><display x="-15" y="-60" w="90" h="60" /><inputs><input type="text" name="queueName" expr="[Queue Name]" /><input type="password" name="storageKey" expr="[Acces Key]" /><input type="text" name="storageAccountName" expr="[Storage Account Name]" /></inputs><outputs><output type="flag" name="success" stage="Success" /><output type="text" name="result" stage="Result" /><output type="collection" name="responseHeaders" stage="Response Headers" /><output type="text" name="httpStatusCode" stage="HTTP Status Code" /><output type="text" name="responseContent" stage="Response Content" /></outputs><onsuccess>279513f8-6121-436f-bf5d-b52164aff009</onsuccess><code><![CDATA[success = true;
result = string.Empty;
responseHeaders = new DataTable();
httpStatusCode = string.Empty;
responseContent = string.Empty;

try
{
	// construct the uri and create the webRequest object
	string queueServiceEndpoint = string.Format("https://{0}.queue.core.windows.net/{1}/messages", storageAccountName, queueName);
	HttpWebRequest webRequest = GetWebRequest("DELETE", storageAccountName, storageKey, queueServiceEndpoint);

	// get the response from the webRequest and process it
	using (HttpWebResponse response = (HttpWebResponse)webRequest.GetResponse())
	{
		// grab the http status code
		httpStatusCode = string.Format("{0} - {1}", ((int)response.StatusCode).ToString(), response.StatusCode.ToString());

		// prep the responseHeaders structure
		responseHeaders.Columns.AddRange(GetResponseHeaderColumns());

		// load up the responseHeaders
		foreach (string k in response.Headers.Keys)
		{
			DataRow row = responseHeaders.NewRow();
			row["Header"] = k;
			row["Value"] = response.Headers.Get(k);
			responseHeaders.Rows.Add(row);
		}

		using (var sr = new StreamReader(response.GetResponseStream()))
		{
			// read in the response stream
			responseContent = sr.ReadToEnd();
			success = true;
		}
	}
}
catch (WebException wex)
{
	result = wex.Message;
	success = false;

	ParseWebExceptionDetails(wex, out httpStatusCode, out responseHeaders, out responseContent);
}
catch (Exception ex)
{
	result = ex.Message;
	success = false;
}
]]></code></stage><stage stageid="f6885ebb-a737-4b43-9eea-331e81270be6" name="Response Headers" type="Collection"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><display x="-195" y="75" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="682cbfdd-3e5e-4657-bc95-9eb87e173168" name="HTTP Status Code" type="Data"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><display x="-195" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4618ac2f-4566-452f-b29d-7a2f0b28ec57" name="Response Content" type="Data"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="279513f8-6121-436f-bf5d-b52164aff009" name="End" type="End"><subsheetid>2909278d-cc31-40aa-8c18-d35da4174ff8</subsheetid><loginhibit /><display x="-15" y="15" /><outputs><output type="flag" name="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="text" name="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs></stage><stage stageid="a674b05a-e81a-4952-ac4a-9f2efaf70ead" name="Update Message" type="SubSheetInfo"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><narrative>Updates a message in the queue.</narrative><display x="-285" y="-105" w="330" h="90" /></stage><stage stageid="5924de06-fbaa-4e29-8822-66fbb7b0e3de" name="Message Content" type="Data"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><display x="-375" y="-15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1e621e2f-d659-4679-8ace-720d3b1addde" name="Input Data Items" type="Block"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><loginhibit /><display x="-450" y="-45" w="150" h="210" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="3c9f3112-08d6-45a7-bdb5-414e5bae95c3" name="Start" type="Start"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><loginhibit /><display x="0" y="-135" /><inputs><input type="number" name="Visibility Timeout Seconds" narrative="Total number of seconds to keep the queue messages retieved invisible to prevent them being processed by another worker. Default is 30." stage="Visibility Timeout Seconds" /><input type="text" name="Message Pop Receipt" narrative="Required. Specifies the valid pop receipt value returned from an earlier call to the Get Messages or Update Message operation." stage="Message Pop Receipt" /><input type="text" name="Message Content" narrative="Required. The content of the message" stage="Message Content" /><input type="text" name="Queue Name" narrative="The name of the Azure Queue" stage="Queue Name" /><input type="password" name="Acces Key" narrative="The access key for the Azure storage account that the Azure Queue belongs to" stage="Acces Key" /><input type="text" name="Storage Account Name" narrative="The name of the Azure storage account that the Azure Queue belongs to" stage="Storage Account Name" /></inputs><onsuccess>14f6f53b-5459-4086-baff-d67d12895c54</onsuccess></stage><stage stageid="91999ff7-4649-48ce-a2a7-c5a858ebf36c" name="Queue Name" type="Data"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><display x="-375" y="135" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c6c4a09e-d7cb-47cf-a931-3e9dec183df4" name="Acces Key" type="Data"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><display x="-375" y="105" w="120" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="fab6c00d-c0e2-4612-896f-0faa2b72a7f7" name="Storage Account Name" type="Data"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><display x="-375" y="75" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="da8be027-697d-4630-bfe0-fc70722c738b" name="Visibility Timeout Seconds" type="Data"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><display x="-375" y="15" w="120" h="30" /><datatype>number</datatype><initialvalue>30</initialvalue><private /><alwaysinit /></stage><stage stageid="6bae9dda-891f-42bd-a23f-a618959ee5dc" name="Success" type="Data"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="917379dc-7cb8-4257-8a4a-93c8f35189a4" name="Result" type="Data"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="96212b51-4675-41bb-b1ee-c25a87ad24a3" name="Messages" type="Collection"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><loginhibit /><display x="-195" y="135" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="d8c62e31-7e58-44c1-af3c-46c401408608" name="Output Data Items" type="Block"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><loginhibit /><display x="-270" y="-45" w="150" h="210" /><font family="Segoe UI" size="10" style="Regular" color="800000" /></stage><stage stageid="53ab22eb-18a3-44fb-b1c1-93716c2e6942" name="Response Headers" type="Collection"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><display x="-195" y="75" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="ce7b2dd4-8590-472b-aed6-8b0d7caa28b7" name="HTTP Status Code" type="Data"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><display x="-195" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6fdd4516-da8f-4b2e-a332-0c358007f92f" name="Response Content" type="Data"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9c5b6315-d1dc-44af-b35c-584998a602a4" name="End" type="End"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><loginhibit /><display x="0" y="15" /><outputs><output type="flag" name="Success" narrative="Flag to indicate success of this action" stage="Success" /><output type="text" name="Result" narrative="If an error occrus, this output will contain text describing result of this action" stage="Result" /><output type="collection" name="Messages" narrative="Messages retrieved from the queue" stage="Messages" /><output type="text" name="HTTP Status Code" narrative="HTTP status code of the request made to the REST API endpoint" stage="HTTP Status Code" /><output type="collection" name="Response Headers" narrative="Collection of the response headers from the request made to the REST API endpoint" stage="Response Headers" /><output type="text" name="Response Content" narrative="The raw response from the request made to the REST API endpoint" stage="Response Content" /></outputs></stage><stage stageid="14f6f53b-5459-4086-baff-d67d12895c54" name="Update Message" type="Code"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><loginhibit /><display x="0" y="-60" w="90" h="60" /><inputs><input type="number" name="visibilityTimeoutSeconds" expr="[Visibility Timeout Seconds]" /><input type="text" name="popReceipt" expr="[Message Pop Receipt]" /><input type="text" name="messageContent" expr="[Message Content]" /><input type="text" name="queueName" expr="[Queue Name]" /><input type="password" name="storageKey" expr="[Acces Key]" /><input type="text" name="storageAccountName" expr="[Storage Account Name]" /></inputs><outputs><output type="flag" name="success" stage="Success" /><output type="text" name="result" stage="Result" /><output type="collection" name="output" stage="Messages" /><output type="collection" name="responseHeaders" stage="Response Headers" /><output type="text" name="httpStatusCode" stage="HTTP Status Code" /><output type="text" name="responseContent" stage="Response Content" /></outputs><onsuccess>9c5b6315-d1dc-44af-b35c-584998a602a4</onsuccess><code><![CDATA[success = true;
result = string.Empty;
output = new DataTable();
responseHeaders = new DataTable();
httpStatusCode = string.Empty;
responseContent = string.Empty;

try
{
	// construct the uri and create the webRequest object
	string queueServiceEndpoint = string.Format("https://{0}.queue.core.windows.net/{1}/messages?popreceipt={2}&visibilitytimeout={3}", storageAccountName, queueName, popReceipt, visibilityTimeoutSeconds);
	HttpWebRequest webRequest = GetWebRequest("PUT", storageAccountName, storageKey, queueServiceEndpoint);

	// wrap the message content in the expected xml structure, convert it to byte[], and set content length
	// - per Microsoft (https://docs.microsoft.com/en-us/rest/api/storageservices/put-message)
	//   "A message must be in a format that can be included in an XML request with UTF-8 encoding. To include markup in the message, 
	//    the contents of the message must either be XML-escaped or Base64-encode. Any XML markup in the message that is not escaped 
	//    or encoded will be removed before the message is added to the queue."
	string postData = string.Format("<QueueMessage><MessageText>{0}</MessageText></QueueMessage>", Convert.ToBase64String(Encoding.UTF8.GetBytes(messageContent)));
	byte[] bytes = Encoding.UTF8.GetBytes(postData);
	webRequest.ContentLength = bytes.Length;
	
	// get the request stream and write the post data to it
	Stream dataStream = webRequest.GetRequestStream();
	dataStream.Write(bytes, 0, bytes.Length);
	dataStream.Close();

	// get the response from the webRequest and process it
	using (HttpWebResponse response = (HttpWebResponse)webRequest.GetResponse())
	{
		// grab the http status code
		httpStatusCode = string.Format("{0} - {1}", ((int)response.StatusCode).ToString(), response.StatusCode.ToString());

		// prep the output structure
		output.Columns.AddRange(GetOutputDataColumns());

		// prep the responseHeaders structure
		responseHeaders.Columns.AddRange(GetResponseHeaderColumns());

		// load up the responseHeaders
		foreach (string k in response.Headers.Keys)
		{
			DataRow row = responseHeaders.NewRow();
			row["Header"] = k;
			row["Value"] = response.Headers.Get(k);
			responseHeaders.Rows.Add(row);
		}
	}
}
catch (WebException wex)
{
	result = wex.Message;
	success = false;

	ParseWebExceptionDetails(wex, out httpStatusCode, out responseHeaders, out responseContent);
}
catch (Exception ex)
{
	result = ex.Message;
	success = false;
}
]]></code></stage><stage stageid="75199ed2-5ba2-4bc2-9141-19112d616354" name="Message Pop Receipt" type="Data"><subsheetid>29520adc-b0c0-40f0-8db2-0f5066302ec8</subsheetid><display x="-375" y="45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="19c7bd93-c960-4cb4-9d22-74bfb9aa9d62" name="Blue Prism Limited Copyright Note" type="Note"><loginhibit /><narrative>'The MIT License'

© 2019 - 2020 Blue Prism Limited

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE</narrative><display x="315" y="-45" w="450" h="210" /><font family="Segoe UI" size="10" style="Bold" color="000000" /></stage></process></object>
        <credential id="38b7adbf-3449-43d3-9bda-aa11e681057f" name="Blueprism - Azure Queues REST API" xmlns="http://www.blueprism.co.uk/product/credential">
            <credentialType>General</credentialType>
            <members>
                <process id="5bc440a8-5066-4269-8ab7-065823ad2a4d" />
                <object id="98f99a73-e4ef-4b02-bb98-5f26efed1394" />
            </members>
        </credential>
        <process-group id="613ef6fe-7d18-4162-8b9d-e7a7cdb3f30e" name="Default" isDefaultGroup="True" xmlns="http://www.blueprism.co.uk/product/process-group">
            <members>
                <process id="5bc440a8-5066-4269-8ab7-065823ad2a4d" />
            </members>
        </process-group>
        <object-group id="37c3b79e-3e31-43e4-9318-34b6c7d918fa" name="Default" isDefaultGroup="True" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="98f99a73-e4ef-4b02-bb98-5f26efed1394" />
            </members>
        </object-group>
    </bpr:contents>
</bpr:release>